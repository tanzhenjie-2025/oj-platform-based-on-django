{% extends 'CheckObjection/CheckObjectionApp_base.html' %}
{% block title %}ç®—æ³•å®éªŒå®¤ - æäº¤è¯¦æƒ…{% endblock %}
{% block head %}
{% load static %}
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>{{ page_title|default:"æäº¤è¯¦æƒ…" }}</title>
    <link rel="stylesheet" href="{% static 'bootstrap5/css/bootstrap.min.css' %}">
    <style>
        :root {
            --primary-gradient: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            --success-gradient: linear-gradient(135deg, #4facfe 0%, #00f2fe 100%);
            --danger-gradient: linear-gradient(135deg, #fa709a 0%, #fee140 100%);
            --warning-gradient: linear-gradient(135deg, #ff9a9e 0%, #fecfef 100%);
            --info-gradient: linear-gradient(135deg, #a8edea 0%, #fed6e3 100%);
        }

        .null-value {
            color: #9ca3af;
            font-style: italic;
        }
        .code-block {
            background: linear-gradient(135deg, #1e293b 0%, #334155 100%);
            color: #e2e8f0;
            padding: 20px;
            border-radius: 12px;
            max-height: 500px;
            overflow: auto;
            font-family: 'Fira Code', 'Courier New', monospace;
            font-size: 0.95em;
            white-space: pre-wrap;
            word-break: break-all;
            border: 1px solid #475569;
            box-shadow: inset 0 2px 10px rgba(0,0,0,0.3);
        }
        .test-case-item {
            border-left: 6px solid #dee2e6;
            transition: all 0.3s ease;
            border-radius: 12px;
            margin-bottom: 16px;
            box-shadow: 0 2px 8px rgba(0,0,0,0.1);
            overflow: hidden;
        }
        .test-case-item:hover {
            transform: translateY(-2px);
            box-shadow: 0 8px 25px rgba(0,0,0,0.15);
        }
        .test-case-accepted {
            border-left-color: #10b981;
            background: linear-gradient(135deg, #d1fae5 0%, #ecfdf5 100%);
        }
        .test-case-wrong {
            border-left-color: #ef4444;
            background: linear-gradient(135deg, #fee2e2 0%, #fef2f2 100%);
        }
        .test-case-running {
            border-left-color: #f59e0b;
            background: linear-gradient(135deg, #fef3c7 0%, #fffbeb 100%);
        }
        .test-case-pending {
            border-left-color: #6b7280;
            background: linear-gradient(135deg, #f3f4f6 0%, #f9fafb 100%);
        }
        .test-case-tle {
            border-left-color: #8b5cf6;
            background: linear-gradient(135deg, #e0e7ff 0%, #eef2ff 100%);
        }
        .test-case-mle {
            border-left-color: #ec4899;
            background: linear-gradient(135deg, #fce7f3 0%, #fdf2f8 100%);
        }
        .status-badge {
            min-width: 100px;
            font-weight: 600;
            font-size: 0.85rem;
            padding: 8px 16px;
            border-radius: 25px;
            box-shadow: 0 2px 8px rgba(0,0,0,0.15);
        }
        .card {
            border: none;
            border-radius: 16px;
            box-shadow: 0 4px 20px rgba(0,0,0,0.08);
            transition: all 0.3s ease;
            overflow: hidden;
        }
        .card:hover {
            box-shadow: 0 8px 30px rgba(0,0,0,0.12);
        }
        .card-header {
            border-bottom: 2px solid rgba(255,255,255,0.1);
            padding: 20px 24px;
            font-weight: 600;
        }
        .bg-gradient-primary {
            background: var(--primary-gradient) !important;
        }
        .bg-gradient-success {
            background: var(--success-gradient) !important;
        }
        .bg-gradient-danger {
            background: var(--danger-gradient) !important;
        }
        .bg-gradient-warning {
            background: var(--warning-gradient) !important;
        }
        .bg-gradient-info {
            background: var(--info-gradient) !important;
        }
        .breadcrumb {
            background: linear-gradient(135deg, #f8fafc 0%, #e2e8f0 100%);
            border-radius: 12px;
            padding: 12px 20px;
            box-shadow: 0 2px 8px rgba(0,0,0,0.06);
        }
        .breadcrumb-item.active {
            color: #4f46e5;
            font-weight: 600;
        }
        .btn-glow {
            background: var(--primary-gradient);
            color: white;
            border: none;
            border-radius: 12px;
            padding: 12px 24px;
            font-weight: 600;
            box-shadow: 0 4px 15px rgba(79, 70, 229, 0.4);
            transition: all 0.3s ease;
        }
        .btn-glow:hover {
            transform: translateY(-2px);
            box-shadow: 0 8px 25px rgba(79, 70, 229, 0.6);
            color: white;
        }
        .info-item {
            background: linear-gradient(135deg, #f8fafc 0%, #f1f5f9 100%);
            border-radius: 12px;
            padding: 16px;
            margin-bottom: 16px;
            border-left: 4px solid #4f46e5;
        }
        .pulse-animation {
            animation: pulse 2s infinite;
        }
        @keyframes pulse {
            0% { opacity: 1; }
            50% { opacity: 0.7; }
            100% { opacity: 1; }
        }
        .language-badge {
            background: linear-gradient(135deg, #8b5cf6 0%, #ec4899 100%);
            color: white;
            font-weight: 600;
            padding: 8px 16px;
            border-radius: 20px;
        }
        .test-count-badge {
            background: linear-gradient(135deg, #f59e0b 0%, #d97706 100%);
            color: white;
            font-weight: 600;
            padding: 6px 12px;
            border-radius: 15px;
        }
        .code-block-small {
            background: #1f2937;
            color: #e5e7eb;
            padding: 8px 12px;
            border-radius: 8px;
            font-family: 'Fira Code', monospace;
            font-size: 0.85em;
            margin: 4px 0;
            white-space: pre-wrap;
            word-break: break-all;
        }
        .result-detail-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 12px;
            margin-bottom: 16px;
        }
        .detail-item {
            background: rgba(255,255,255,0.7);
            padding: 12px;
            border-radius: 8px;
            text-align: center;
        }
        .detail-label {
            font-size: 0.8em;
            color: #6b7280;
            margin-bottom: 4px;
        }
        .detail-value {
            font-weight: 600;
            font-size: 1em;
        }
        .score-badge {
            background: linear-gradient(135deg, #10b981 0%, #059669 100%);
            color: white;
            padding: 4px 12px;
            border-radius: 20px;
            font-weight: 600;
            font-size: 0.9em;
        }
    </style>
</head>
{% endblock %}
{% block main %}
<body style="background: linear-gradient(135deg, #f8fafc 0%, #e2e8f0 100%); min-height: 100vh;">
    <div class="container py-4">
        <div class="row">
            <div class="col-12">
                <!-- é¢åŒ…å±‘å¯¼èˆª -->
                <nav aria-label="breadcrumb" class="mb-4">
                    <ol class="breadcrumb">
                        <li class="breadcrumb-item">
                            <a href="#" style="text-decoration: none; color: #64748b;">ğŸ“Š æäº¤è®°å½•</a>
                        </li>
                        <li class="breadcrumb-item active">ğŸ” æäº¤è¯¦æƒ…</li>
                    </ol>
                </nav>

                <!-- é¡µé¢æ ‡é¢˜ -->
                <div class="text-center mb-5">
                    <h1 class="display-5 fw-bold" style="background: var(--primary-gradient); -webkit-background-clip: text; -webkit-text-fill-color: transparent; background-clip: text;">
                        ğŸš€ {{ page_title|default:"æäº¤è¯¦æƒ…" }}
                    </h1>
                    <p class="text-muted">æŸ¥çœ‹ä»£ç æäº¤çš„è¯¦ç»†ä¿¡æ¯å’Œæµ‹è¯•ç»“æœ</p>
                </div>

                <!-- åŸºæœ¬ä¿¡æ¯å¡ç‰‡ -->
                <div class="card mb-5">
                    <div class="card-header bg-gradient-primary text-white">
                        <h5 class="mb-0">ğŸ“‹ åŸºæœ¬ä¿¡æ¯</h5>
                    </div>
                    <div class="card-body p-4">
                        <div class="row g-4">
                            <div class="col-md-4">
                                <div class="info-item">
                                    <strong>ğŸ†” æäº¤ID:</strong>
                                    <div class="mt-2">
                                        {% if submission.id %}
                                            <code style="background: #4f46e5; color: white; padding: 4px 8px; border-radius: 6px;">{{ submission.id }}</code>
                                        {% else %}
                                            <span class="null-value">æœªåˆ†é…</span>
                                        {% endif %}
                                    </div>
                                </div>
                            </div>
                            <div class="col-md-4">
                                <div class="info-item">
                                    <strong>ğŸ‘¤ ç”¨æˆ·å:</strong>
                                    <div class="mt-2">
                                        {% if submission.user_name %}
                                            <span class="badge language-badge">{{ submission.user_name }}</span>
                                        {% else %}
                                            <span class="null-value">æœªçŸ¥ç”¨æˆ·</span>
                                        {% endif %}
                                    </div>
                                </div>
                            </div>
                            <div class="col-md-4">
                                <div class="info-item">
                                    <strong>ğŸ“ é¢˜ç›®ID:</strong>
                                    <div class="mt-2">
                                        {% if submission.topic_id %}
                                            <span style="color: #4f46e5; font-weight: 600; font-size: 1.1em;">{{ submission.topic_id }}</span>
                                        {% else %}
                                            <span class="null-value">æœªçŸ¥é¢˜ç›®</span>
                                        {% endif %}
                                    </div>
                                </div>
                            </div>
                            <div class="col-md-4">
                                <div class="info-item">
                                    <strong>ğŸ’» ç¼–ç¨‹è¯­è¨€:</strong>
                                    <div class="mt-2">
                                        {% if submission.language_id %}
                                            <span class="badge language-badge">
                                                {% if submission.language_id == 71 %}
                                                    ğŸ Python
                                                {% elif submission.language_id == 54 %}
                                                    âš¡ C++
                                                {% elif submission.language_id == 62 %}
                                                    â˜• Java
                                                {% else %}
                                                    ğŸ”§ å…¶ä»– (ID: {{ submission.language_id }})
                                                {% endif %}
                                            </span>
                                        {% else %}
                                            <span class="null-value">æœªæŒ‡å®š</span>
                                        {% endif %}
                                    </div>
                                </div>
                            </div>
                            <div class="col-md-4">
                                <div class="info-item">
                                    <strong>ğŸ“Š çŠ¶æ€:</strong>
                                    <div class="mt-2">
                                        {% if submission.status %}
                                            {% if submission.status == 'Accepted' %}
                                                <span class="badge bg-gradient-success status-badge">âœ… {{ submission.status }}</span>
                                            {% elif submission.status == 'Wrong Answer' %}
                                                <span class="badge bg-gradient-danger status-badge">âŒ {{ submission.status }}</span>
                                            {% elif submission.status == 'Running' %}
                                                <span class="badge bg-gradient-warning status-badge pulse-animation">â³ {{ submission.status }}</span>
                                            {% elif submission.status == 'Compile Error' %}
                                                <span class="badge bg-gradient-danger status-badge">ğŸ”§ {{ submission.status }}</span>
                                            {% else %}
                                                <span class="badge bg-secondary status-badge">{{ submission.status }}</span>
                                            {% endif %}
                                        {% else %}
                                            <span class="badge bg-light text-dark status-badge null-value">æœªçŸ¥çŠ¶æ€</span>
                                        {% endif %}
                                    </div>
                                </div>
                            </div>
                            <div class="col-md-4">
                                <div class="info-item">
                                    <strong>ğŸ¯ æ€»ä½“ç»“æœ:</strong>
                                    <div class="mt-2">
                                        {% if submission.overall_result %}
                                            {% if submission.overall_result == 'AC' %}
                                                <span class="badge bg-gradient-success status-badge">âœ… AC</span>
                                            {% elif submission.overall_result == 'WA' %}
                                                <span class="badge bg-gradient-danger status-badge">âŒ WA</span>
                                            {% elif submission.overall_result == 'TLE' %}
                                                <span class="badge bg-gradient-warning status-badge">â° TLE</span>
                                            {% elif submission.overall_result == 'MLE' %}
                                                <span class="badge bg-gradient-info status-badge">ğŸ’¾ MLE</span>
                                            {% elif submission.overall_result == 'RE' %}
                                                <span class="badge bg-gradient-danger status-badge">ğŸ’¥ RE</span>
                                            {% elif submission.overall_result == 'CE' %}
                                                <span class="badge bg-gradient-danger status-badge">ğŸ”§ CE</span>
                                            {% else %}
                                                <span class="badge bg-secondary status-badge">{{ submission.overall_result }}</span>
                                            {% endif %}
                                        {% else %}
                                            <span class="null-value">æš‚æ— ç»“æœ</span>
                                        {% endif %}
                                    </div>
                                </div>
                            </div>
                            <div class="col-md-6">
                                <div class="info-item">
                                    <strong>ğŸ• åˆ›å»ºæ—¶é—´:</strong>
                                    <div class="mt-2">
                                        {% if submission.created_at %}
                                            <span style="color: #059669; font-weight: 500;">{{ submission.created_at|date:"Y-m-d H:i:s" }}</span>
                                        {% else %}
                                            <span class="null-value">æœªçŸ¥æ—¶é—´</span>
                                        {% endif %}
                                    </div>
                                </div>
                            </div>
                            <div class="col-md-6">
                                <div class="info-item">
                                    <strong>ğŸ”„ æ›´æ–°æ—¶é—´:</strong>
                                    <div class="mt-2">
                                        {% if submission.updated_at %}
                                            <span style="color: #dc2626; font-weight: 500;">{{ submission.updated_at|date:"Y-m-d H:i:s" }}</span>
                                        {% else %}
                                            <span class="null-value">æœªçŸ¥æ—¶é—´</span>
                                        {% endif %}
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>

                <div class="row">
                    <!-- æºä»£ç å±•ç¤º -->
                    <div class="col-lg-6 mb-4">
                        <div class="card h-100">
                            <div class="card-header bg-gradient-primary text-white d-flex justify-content-between align-items-center">
                                <h5 class="mb-0">ğŸ“œ æºä»£ç </h5>
                                {% if submission.language_id %}
                                    <span class="badge bg-light text-dark">
                                        {% if submission.language_id == 71 %}ğŸ Python
                                        {% elif submission.language_id == 54 %}âš¡ C++
                                        {% elif submission.language_id == 62 %}â˜• Java
                                        {% else %}ğŸ”§ Language {{ submission.language_id }}
                                        {% endif %}
                                    </span>
                                {% endif %}
                            </div>
                            <div class="card-body p-0">
                                {% if submission.source_code %}
                                    <pre class="code-block m-0"><code>{{ submission.source_code }}</code></pre>
                                {% else %}
                                    <div class="p-5 text-center">
                                        <span class="null-value">ğŸ“­ æš‚æ— æºä»£ç </span>
                                    </div>
                                {% endif %}
                            </div>
                        </div>
                    </div>

                    <!-- æµ‹è¯•ç»“æœ -->
                    <div class="col-lg-6 mb-4">
                        <div class="card h-100">
                            <div class="card-header bg-gradient-success text-white d-flex justify-content-between align-items-center">
                                <h5 class="mb-0">ğŸ§ª æµ‹è¯•ç»“æœ</h5>
                                {% if submission.results %}
                                    <span class="badge test-count-badge">{{ submission.results|length }} ä¸ªæµ‹è¯•ç”¨ä¾‹</span>
                                {% endif %}
                            </div>
                            <div class="card-body p-4">
                                {% if submission.results %}
                                    <div class="mb-4">
                                        <small class="text-muted">å…± {{ submission.results|length }} ä¸ªæµ‹è¯•ç”¨ä¾‹</small>
                                    </div>

                                    {% for result in submission.results %}
                                    <div class="test-case-item p-4
                                        {% if result.result.status == 'Accepted' %}test-case-accepted
                                        {% elif result.result.status == 'Wrong Answer' %}test-case-wrong
                                        {% elif result.result.status == 'Running' %}test-case-running
                                        {% elif result.result.status == 'Time Limit Exceeded' %}test-case-tle
                                        {% elif result.result.status == 'Memory Limit Exceeded' %}test-case-mle
                                        {% else %}test-case-pending
                                        {% endif %}">

                                        <!-- æµ‹è¯•ç”¨ä¾‹å¤´éƒ¨ -->
                                        <div class="d-flex justify-content-between align-items-center mb-3">
                                            <div class="d-flex align-items-center gap-3">
                                                <strong>ğŸ“‹ æµ‹è¯•ç”¨ä¾‹ {{ forloop.counter }}</strong>
                                                {% if result.is_sample %}
                                                <span class="badge bg-info" style="font-size: 0.7em;">æ ·ä¾‹</span>
                                                {% endif %}
{#                                                <span class="score-badge">å¾—åˆ†: {{ result.score }}</span>#}
                                            </div>
                                            <span class="badge status-badge
                                                {% if result.result.status == 'Accepted' %}bg-gradient-success
                                                {% elif result.result.status == 'Wrong Answer' %}bg-gradient-danger
                                                {% elif result.result.status == 'Time Limit Exceeded' %}bg-gradient-warning
                                                {% elif result.result.status == 'Memory Limit Exceeded' %}bg-gradient-info
                                                {% elif result.result.status == 'Runtime Error' %}bg-gradient-danger
                                                {% elif result.result.status == 'Running' %}bg-gradient-warning pulse-animation
                                                {% else %}bg-secondary{% endif %}">
                                                {% if result.result.status == 'Accepted' %}âœ… Accepted
                                                {% elif result.result.status == 'Wrong Answer' %}âŒ Wrong Answer
                                                {% elif result.result.status == 'Time Limit Exceeded' %}â° Time Limit Exceeded
                                                {% elif result.result.status == 'Memory Limit Exceeded' %}ğŸ’¾ Memory Limit Exceeded
                                                {% elif result.result.status == 'Runtime Error' %}ğŸ’¥ Runtime Error
                                                {% elif result.result.status == 'Running' %}â³ Running
                                                {% else %}â³ {{ result.result.status|default:"Pending" }}
                                                {% endif %}
                                            </span>
                                        </div>

                                        <!-- æ€§èƒ½æŒ‡æ ‡ç½‘æ ¼ -->
                                        <div class="result-detail-grid">
                                            <div class="detail-item">
                                                <div class="detail-label">â±ï¸ è¿è¡Œæ—¶é—´</div>
                                                <div class="detail-value" style="color: #059669;">{{ result.result.time }}s</div>
                                            </div>
                                            <div class="detail-item">
                                                <div class="detail-label">ğŸ’¾ å†…å­˜ä½¿ç”¨</div>
                                                <div class="detail-value" style="color: #3b82f6;">{{ result.result.memory }}KB</div>
                                            </div>
                                            <div class="detail-item">
                                                <div class="detail-label">ğŸ“Š çŠ¶æ€ID</div>
                                                <div class="detail-value">{{ result.result.status_id }}</div>
                                            </div>
                                        </div>

                                        <!-- è¾“å…¥è¾“å‡ºå¯¹æ¯” -->
                                        <div class="mt-3 p-3 rounded" style="background: rgba(255,255,255,0.7);">
                                            <!-- è¾“å…¥æ•°æ® -->
                                            <div class="mb-3">
                                                <small><strong>ğŸ“¥ è¾“å…¥æ•°æ®:</strong></small>
                                                <div class="code-block-small mt-1">
                                                    {{ result.input_data }}
                                                </div>
                                            </div>

                                            <!-- é¢„æœŸè¾“å‡ºå’Œå®é™…è¾“å‡º -->
                                            <div class="row">
                                                <div class="col-md-6">
                                                    <small><strong>ğŸ“¤ é¢„æœŸè¾“å‡º:</strong></small>
                                                    <div class="code-block-small mt-1">
                                                        {{ result.expected_output }}
                                                    </div>
                                                </div>
                                                <div class="col-md-6">
                                                    <small><strong>ğŸ“¥ å®é™…è¾“å‡º:</strong></small>
                                                    <div class="code-block-small mt-1">
                                                        {{ result.user_output }}
                                                    </div>
                                                </div>
                                            </div>

                                            <!-- æ ‡å‡†è¾“å‡ºå’Œæ ‡å‡†é”™è¯¯ -->
                                            {% if result.result.stdout or result.result.stderr %}
                                            <div class="row mt-3">
                                                {% if result.result.stdout %}
                                                <div class="col-md-6">
                                                    <small><strong>ğŸ“„ æ ‡å‡†è¾“å‡º:</strong></small>
                                                    <div class="code-block-small mt-1">
                                                        {{ result.result.stdout }}
                                                    </div>
                                                </div>
                                                {% endif %}
                                                {% if result.result.stderr %}
                                                <div class="col-md-6">
                                                    <small><strong>âŒ æ ‡å‡†é”™è¯¯:</strong></small>
                                                    <div class="code-block-small mt-1">
                                                        {{ result.result.stderr }}
                                                    </div>
                                                </div>
                                                {% endif %}
                                            </div>
                                            {% endif %}

                                            <!-- ç¼–è¯‘è¾“å‡º -->
                                            {% if result.result.compile_output %}
                                            <div class="mt-3">
                                                <small><strong>ğŸ”§ ç¼–è¯‘è¾“å‡º:</strong></small>
                                                <div class="code-block-small mt-1">
                                                    {{ result.result.compile_output }}
                                                </div>
                                            </div>
                                            {% endif %}
                                        </div>

                                        <!-- æ¶ˆæ¯ -->
                                        {% if result.result.message %}
                                        <div class="mt-3">
                                            <small><strong>ğŸ’¬ æ‰§è¡Œæ¶ˆæ¯:</strong> {{ result.result.message }}</small>
                                        </div>
                                        {% endif %}
                                    </div>
                                    {% endfor %}
                                {% else %}
                                    <div class="text-center py-5">
                                        <span class="null-value">ğŸ“­ æš‚æ— æµ‹è¯•ç»“æœ</span>
                                        {% if submission.status == 'Running' %}
                                        <div class="mt-3">
                                            <div class="spinner-border text-warning" role="status">
                                                <span class="visually-hidden">æ­£åœ¨è¯„æµ‹...</span>
                                            </div>
                                            <small class="text-muted d-block mt-2">æ­£åœ¨è¯„æµ‹ä¸­...</small>
                                        </div>
                                        {% endif %}
                                    </div>
                                {% endif %}
                            </div>
                        </div>
                    </div>
                </div>

                <!-- å¤‡æ³¨ä¿¡æ¯ -->
                <div class="row">
                    <div class="col-12">
                        <div class="card mb-4">
                            <div class="card-header bg-gradient-info text-white d-flex justify-content-between align-items-center">
                                <h5 class="mb-0">ğŸ“ å¤‡æ³¨ä¿¡æ¯</h5>
                                {% if not submission.notes %}
                                    <span class="badge bg-light text-dark">æ— å¤‡æ³¨</span>
                                {% endif %}
                            </div>
                            <div class="card-body p-4">
                                {% if submission.notes %}
                                    <div class="notes-content p-3 rounded" style="background: #f8fafc; border-left: 4px solid #4f46e5;">
                                        {{ submission.notes|linebreaks }}
                                    </div>
                                {% else %}
                                    <div class="text-center py-4">
                                        <span class="null-value">ğŸ“­ æš‚æ— å¤‡æ³¨ä¿¡æ¯</span>
                                    </div>
                                {% endif %}
                            </div>
                        </div>
                    </div>
                </div>

                <!-- æ“ä½œæŒ‰é’® -->
                <div class="row">
                    <div class="col-12">
                        <div class="d-flex justify-content-between align-items-center p-4 rounded" style="background: linear-gradient(135deg, #f8fafc 0%, #e2e8f0 100%);">
                            <a href="#" class="btn btn-outline-secondary rounded-pill px-4">
                                â† è¿”å›åˆ—è¡¨
                            </a>

                            <div class="d-flex gap-3">
                                {% if submission.status == 'Running' %}
                                <button class="btn btn-glow" onclick="location.reload()">
                                    ğŸ”„ åˆ·æ–°çŠ¶æ€
                                </button>
                                {% endif %}

                                {% if submission.source_code %}
                                <button class="btn btn-glow" onclick="copySourceCode()">
                                    ğŸ“‹ å¤åˆ¶ä»£ç 
                                </button>
                                {% endif %}
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <script>
        function copySourceCode() {
            const sourceCode = `{{ submission.source_code|escapejs }}`;
            navigator.clipboard.writeText(sourceCode).then(function() {
                // æ˜¾ç¤ºå¤åˆ¶æˆåŠŸæç¤º
                const btn = event.target;
                const originalText = btn.innerHTML;
                btn.innerHTML = 'âœ… å·²å¤åˆ¶';
                btn.style.background = 'linear-gradient(135deg, #10b981 0%, #059669 100%)';

                setTimeout(function() {
                    btn.innerHTML = originalText;
                    btn.style.background = 'var(--primary-gradient)';
                }, 2000);
            }).catch(function(err) {
                console.error('å¤åˆ¶å¤±è´¥: ', err);
                alert('å¤åˆ¶å¤±è´¥ï¼Œè¯·æ‰‹åŠ¨å¤åˆ¶ä»£ç ');
            });
        }

        // è‡ªåŠ¨åˆ·æ–°æ­£åœ¨è¿è¡Œçš„ä»»åŠ¡
        {% if submission.status == 'Running' %}
        setTimeout(function() {
            location.reload();
        }, 5000); // 5ç§’åè‡ªåŠ¨åˆ·æ–°
        {% endif %}

        // å¤„ç†é¡µé¢åŠ è½½
        document.addEventListener('DOMContentLoaded', function() {
            // ä¸ºä»£ç å—æ·»åŠ ç®€å•çš„è¯­æ³•é«˜äº®
            const codeBlocks = document.querySelectorAll('pre code');
            codeBlocks.forEach(function(block) {
                // ç®€å•çš„å…³é”®è¯é«˜äº®
                const code = block.textContent;
                // è¿™é‡Œå¯ä»¥æ·»åŠ æ›´å¤æ‚çš„é«˜äº®é€»è¾‘ï¼Œä½†ä¸ºäº†ç¨³å®šæ€§å…ˆä¿æŒç®€å•
                block.innerHTML = code;
            });

            // æ·»åŠ å¡ç‰‡æ‚¬åœæ•ˆæœ
            const cards = document.querySelectorAll('.card');
            cards.forEach(card => {
                card.addEventListener('mouseenter', function() {
                    this.style.transform = 'translateY(-5px)';
                });
                card.addEventListener('mouseleave', function() {
                    this.style.transform = 'translateY(0)';
                });
            });
        });
    </script>
</body>
{% endblock %}